# æ–¹æ³•æ€è·¯

## ä¸€ã€RAG éƒ¨åˆ†

1. é¦–å…ˆç¼–å†™ä¸€ä¸ªragé›å½¢
2. å¯¹äºåˆ†å—ï¼Œè€ƒè™‘å•æ¡ˆä¾‹ä¸­çš„ä»£ç åˆ†å—ã€ç„¶åå¯¹äºåˆ†å¥½å—çš„å†…å®¹ï¼Œä½œä¸ºä¸€ä¸ªå¤§å—ã€‚æœ€åæ£€ç´¢æŒ‰ç…§å¤§å—æ¥è¾“å‡ºæ£€ç´¢å†…å®¹ã€‚ï¼ˆåªä½¿ç”¨ä¿®å¤å‰çš„æ¡ˆä¾‹ï¼‰
3. è€ƒè™‘åˆ†å®Œå—ä¹‹åå¦‚ä½•ä¸embeddingç»“åˆï¼Œå¹¶ä¸”å¯¹äºè¾“å‡ºçš„æ£€ç´¢å†…å®¹ä¹Ÿè¦è€ƒè™‘æ€ä¹ˆä½œä¸ºå¤§å—å»è¾“å‡ºembeddingä½œä¸ºä¸€ä¸ªæ•´ä½“ã€‚å­˜æ”¾åœ¨å‘é‡æ•°æ®åº“ä¸­
4. å¯¹æ–°çš„ä¿®å¤æ¡ˆä¾‹è¿›è¡Œåˆ†å—å’Œembeddingï¼Œå¾—åˆ°ç›¸ä¼¼çš„ç‰‡æ®µ
5. ç¼–å†™é‡æ’åºç®—æ³•æ¥å¾—åˆ°å®é™…ä¸Šæœ€ç›¸ä¼¼çš„ç‰‡æ®µ



### ç»“æ„åŒ– + åˆ†å— + åˆ†å±‚ç´¢å¼•çš„åæ¨¡å¼ RAG

```txt
[åæ¨¡å¼æ¡ˆä¾‹] â†’ [å­å—ä»¬] â†’ [ç»“æ„+è¯­ä¹‰å‘é‡] â†’ [å­å—æ£€ç´¢] â†’ [èšåˆçˆ¶æ¡ˆä¾‹] â†’ [æ„å»ºä¸Šä¸‹æ–‡] â†’ [LLM ç”Ÿæˆä¿®å¤å»ºè®®]
```

## äºŒã€LLM å¾®è°ƒéƒ¨åˆ†

é€šè¿‡å®Œæ•´çš„æ•°æ®é›†é¢„è®­ç»ƒå¤§æ¨¡å‹ï¼Œå®Œæˆå¾®è°ƒã€‚

ä¿è¯é¢„è®­ç»ƒæ—¶ä¸ragçš„promptç­‰ä¿¡æ¯ä¸€è‡´ï¼Œå®Œæˆæ¶æ„åæ¨¡å¼é‡æ„ä¸“ç”¨LLM







![image-20250713205054662](/Users/moncheri/Downloads/main/é‡æ„/fse/image-20250713205054662.png)



![image-20250713205109910](/Users/moncheri/Downloads/main/é‡æ„/fse/image-20250713205109910.png)



![image-20250713205233760](/Users/moncheri/Downloads/main/é‡æ„/fse/image-20250713205233760.png)



![image-20250713225853046](../../../fse/image-20250713225853046.png)









```bash
antipattern-rag/
â”œâ”€â”€ data/                          # âœ… å­˜æ”¾åŸå§‹æ•°æ®å’Œç»“æ„ä¿¡æ¯
â”‚   â”œâ”€â”€ 
â”‚   â”œâ”€â”€ 
â”‚   â””â”€â”€ CH                 				# CHæ¡ˆä¾‹é›†

â”œâ”€â”€ docs/                          # ğŸ“„ é¡¹ç›®æ–‡æ¡£ï¼ˆè¯´æ˜ã€è®¾è®¡å›¾ï¼‰
â”‚   â””â”€â”€ rag_pipeline.md           # æ•´ä½“æµç¨‹è¯´æ˜

â”œâ”€â”€ embeddings/                   # âœ… å‘é‡ç”Ÿæˆæ¨¡å—
â”‚   â”œâ”€â”€ code_embedding.py         # ç”¨CodeBERT/CodeT5ç”Ÿæˆè¯­ä¹‰å‘é‡
â”‚   â”œâ”€â”€ structure_features.py     # è‡ªå®šä¹‰ç»“æ„å‘é‡æå–é€»è¾‘
â”‚   â””â”€â”€ hybrid_embedder.py        # æ‹¼æ¥ç»“æ„+è¯­ä¹‰å‘é‡

â”œâ”€â”€ retriever/                    # âœ… è‡ªå®šä¹‰æ£€ç´¢é€»è¾‘
â”‚   â”œâ”€â”€ subchunk_retriever.py     # å­å—çº§æ£€ç´¢é€»è¾‘
â”‚   â”œâ”€â”€ parent_aggregator.py      # å­å—â†’çˆ¶å—èšåˆå™¨
â”‚   â””â”€â”€ reranker.py               # å¯é€‰ï¼šäºŒæ¬¡æ’åºé€»è¾‘

â”œâ”€â”€ splitter/                     # âœ… è‡ªå®šä¹‰åˆ†å—å™¨
â”‚   â”œâ”€â”€ case_splitter.py          # ç®€å•çš„åˆ†å—æ¡ˆä¾‹
â”‚   â”œâ”€â”€ java_only_splitter.py     # åªå¯¹javaä»£ç è¿›è¡Œåˆ†å—
â”‚   â”œâ”€â”€ json_only_splitter.py     # åªå¯¹jsonå†…å®¹è¿›è¡Œåˆ†å—
â”‚   â”œâ”€â”€ json_java_splitter.py     # å¯¹javaå’Œjsonå†…å®¹è¿›è¡Œç®€å•çš„åˆ†å—
â”‚   â”œâ”€â”€ runner.py          				# æ‰«ææ–‡ä»¶ã€è°ƒç”¨splitterå¾—åˆ°chunk
â”‚   â””â”€â”€ strategy_registry.py      # é€‰æ‹©åˆ†å—ç­–ç•¥


â”œâ”€â”€ langchain_rag/                # âœ… çˆ¶å­åˆ†å—éœ€è¦è°ƒç”¨çš„ä»£ç æ–‡ä»¶å¤¹
â”‚   

â”œâ”€â”€ pipeline/                     # âœ… æµç¨‹æ§åˆ¶ï¼ˆå¯å¯¹æ¥ LangChainï¼‰
â”‚   â”œâ”€â”€ rag_chain.py              # ä¸» RAG ç»„åˆé€»è¾‘
â”‚   â”œâ”€â”€ retriever_wrapper.py      # ç»§æ‰¿ LangChain BaseRetriever
â”‚   â””â”€â”€ prompt_template.py        # LLM æç¤ºæ¨¡æ¿è®¾è®¡

â”œâ”€â”€ llm/                          # âœ… LLM æ¥å…¥ä¸è¾“å‡ºå¤„ç†
â”‚   â”œâ”€â”€ llm_provider.py           # æ¥ OpenAI / æœ¬åœ°æ¨¡å‹
â”‚   â””â”€â”€ fix_parser.py             # LLM è¾“å‡ºç»“æœç»“æ„åŒ–è§£æå™¨

â”œâ”€â”€ main.py                       # âœ… ç”¨äºè°ƒç”¨çš„ä¸»ç¨‹åº

â”œâ”€â”€ tests/                        # âœ… æµ‹è¯•ç”¨ä¾‹
â”‚   â”œâ”€â”€ test_splitter.py
â”‚   â”œâ”€â”€ test_retriever.py
â”‚   â””â”€â”€ test_chain.py

â”œâ”€â”€ config/                       # âœ… é…ç½®é¡¹
â”‚   â””â”€â”€ settings.yaml             # å‘é‡ç»´åº¦ã€è·¯å¾„ã€æ¨¡å‹é€‰æ‹©ç­‰

â”œâ”€â”€ requirements.txt              # Pythonä¾èµ–ï¼ˆLangChainã€transformersç­‰ï¼‰
â”œâ”€â”€ README.md                     # ä½¿ç”¨è¯´æ˜
â””â”€â”€ .env                          # OpenAI key æˆ–æœ¬åœ°æ¨¡å‹è·¯å¾„
```



```
pipeline/rag_chain.py â€” æ„å»ºæœ€åŸºæœ¬çš„ RAG Chain

app/main.py â€” CLI å¯åŠ¨å…¥å£ï¼Œè°ƒç”¨ RAG Chain

splitter/case_splitter.py â€” åŸºç¡€æ–‡æœ¬åˆ†å—å™¨ç¤ºä¾‹

embeddings/code_embedding.py â€” ç®€å•è°ƒç”¨ OpenAI Embeddingsï¼ˆç¤ºèŒƒï¼‰

retriever/retriever_wrapper.py â€” ç»§æ‰¿ LangChain BaseRetrieverï¼Œæ–¹ä¾¿æœªæ¥æ‰©å±•

config/settings.yaml â€” ç®€å•é…ç½®ç¤ºä¾‹

requirements.txt â€” ä¾èµ–åˆ—è¡¨

.env â€” ç¯å¢ƒå˜é‡ç¤ºèŒƒ

README.md â€” ç®€å•è¯´æ˜
```



```
å…ˆç»™æˆ‘ç›®å½•ç»“æ„å§ï¼Œå…ˆæŠŠæ€»ä½“çš„ç›®å½•è§„åˆ’å¥½ï¼Œç„¶åå†è€ƒè™‘å¦‚ä½•å†™ä»£ç ã€‚æˆ‘ç»™ä½ æˆ‘çš„é€»è¾‘ï¼šè¦ç”¨åˆ°langchain_ragä¸­çš„çˆ¶å­åˆ†å—ï¼Œæ¯ä¸ªçˆ¶å—å°±æ˜¯ä¸€ä¸ªåæ¨¡å¼æ¡ˆä¾‹ã€‚å­å—åŒ…å«çš„å†…å®¹æ¯”è¾ƒå¤šã€‚è¿™å„¿ç”¨åˆ°çš„æ˜¯çˆ¶ã€å­1ã€å­2ã€‚ä¸‰å±‚ç»“æ„ã€‚çˆ¶å—å°±æ˜¯ä¸€ä¸ªåæ¨¡å¼æ¡ˆä¾‹ã€‚å¯¹äºchåæ¨¡å¼ï¼Œå¯ä»¥ç¡®å®šçš„æ˜¯æ¯ä¸ªæ¡ˆä¾‹åŒ…å«2ä¸ªjavaæ–‡ä»¶å’Œä¸€ä¸ªjsonæ–‡ä»¶ï¼Œæ‰€ä»¥çˆ¶å—åŒ…å«3ä¸ªå­å—ï¼šsuperClassã€subClassä¸¤ä¸ªjavaæ–‡ä»¶å’Œä¸€ä¸ªå«æœ‰åæ¨¡å¼å…·ä½“ä¿¡æ¯çš„jsonæ–‡ä»¶ ã€‚ç„¶åæ˜¯å†å¾€ä¸‹çš„å­å—ã€‚superClasså’ŒsubClassåŒ…å«å­å—ã€‚superClassçš„å­å—å†…å®¹ä¸ºï¼š1. çˆ¶ç±»è°ƒç”¨å­ç±»æ–¹æ³•çš„ä»£ç å—çš„astè¡¨å¾ 2.çˆ¶ç±»javaæ–‡ä»¶çš„ç»“æ„astè¡¨å¾ 3. çˆ¶ç±»æ–‡ä»¶çš„åæ¨¡å¼ç›¸å…³å†…å®¹å¤§æ¨¡å‹åˆ†æ ã€‚subClassçš„å­å—å†…å®¹ä¸ºï¼š1. å­ç±»è¢«çˆ¶ç±»è°ƒç”¨çš„æ–¹æ³•çš„astè¡¨å¾ 3. å­ç±»javaæ–‡ä»¶çš„ç»“æ„astè¡¨å¾ 3. å­ç±»æ–‡ä»¶çš„åæ¨¡å¼ç›¸å…³å†…å®¹å¤§æ¨¡å‹åˆ†æã€‚ å¯¹äºjsonæ–‡ä»¶ï¼Œæˆ‘ç»™ä½ ä¸€ä¸ªæ ·ä¾‹ï¼šæˆ‘ç°åœ¨ä¸æ¸…æ¥šæ˜¯å¦éœ€è¦å¯¹jsonæ–‡ä»¶ä¹Ÿåšå­chunkã€‚ä½†éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œä¸Šé¢çš„æœ€åº•å±‚çš„å­chunkï¼Œæœ€å¥½ä¸è¦ä½“ç°å‡ºè¯­ä¹‰ä¿¡æ¯ï¼Œåªä½“ç°è¯­æ³•ä¿¡æ¯ï¼Œå› ä¸ºæˆ‘å·²ç»è·Ÿä½ å¼ºè°ƒå¾ˆå¤šæ¬¡äº†ï¼šæ¯ä¸ªæ¡ˆä¾‹çš„ä»£ç éƒ½ä¸ç›¸å…³ï¼Œé è¯­ä¹‰åŒ¹é…æ˜¯ä¸åˆç†çš„ã€‚è¯·ä½ ç»™æˆ‘åˆé€‚çš„ç›®å½•ç»“æ„ä»¥åŠåº”è¯¥åˆ›å»ºçš„pyæ–‡ä»¶ç»“æ„
```

```
splitter/
â””â”€â”€ ch_ast_splitter/
    â”œâ”€â”€ ast_case_splitter.py       # ğŸ’¡ ä¸»é€»è¾‘ï¼šç»„è£…çˆ¶å­å­å­å—
    â”œâ”€â”€ ast_extractor.py           # ğŸ§  ASTç»“æ„æå–å™¨ï¼ˆé™æ€åˆ†æï¼‰
    â”œâ”€â”€ json_processor.py          # ğŸ“„ æå–CHç»“æ„ä¿¡æ¯
    â”œâ”€â”€ context_selector.py        # ğŸ“ æ§åˆ¶ä¸Šä¸‹æ–‡èŒƒå›´
    â”œâ”€â”€ llm_placeholder.py         # ğŸ¤– Mock LLMåˆ†æ
    â”œâ”€â”€ ast_chunk_schema.py        # ğŸ§© ASTå—ç»“æ„å®šä¹‰ï¼ˆåŒ…æ‹¬ ASTChunk å’Œ ASTChunkType æšä¸¾ï¼‰
```



| å±‚çº§   | ç±»å‹                                        | è¯´æ˜                                                     |
| ------ | ------------------------------------------- | -------------------------------------------------------- |
| çˆ¶å—   | **åæ¨¡å¼æ¡ˆä¾‹**                              | ä¸€ä¸ªCHæ¡ˆä¾‹ï¼Œç»Ÿä¸€å°è£…ä¸ºçˆ¶å—ï¼ŒåŒ…å«å­ç±»ã€çˆ¶ç±»ä»£ç å’Œjsonæ ‡æ³¨ |
| å­å—   | `superClass` / `subClass` / `jsonMeta`      | æ¯ç±»æ–‡ä»¶ä¸ºä¸€ä¸ªå­å—ï¼Œå°è£…ç»“æ„                             |
| å­å­å— | `ast_code`, `ast_structure`, `llm_analysis` | è¯­æ³•çº§å­å†…å®¹ï¼Œæ„æˆæœ€ç»ˆå‘é‡åŒ–çš„å†…å®¹ç²’åº¦                   |





## CH-PROMPT

### ğŸ”· 1. `PARENT_FILE_SUMMARY`

#### ä¸­æ–‡ç‰ˆ

```
### SYSTEM
ä½ æ˜¯ä¸€ä½ Java æ¶æ„åˆ†æå¸ˆã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ªå­˜åœ¨ Cyclic Hierarchyï¼ˆå¾ªç¯ç»§æ‰¿ï¼‰åæ¨¡å¼çš„ Java çˆ¶ç±»æ–‡ä»¶ï¼Œè¯·æå–è¯¥ç±»çš„ç»“æ„å’ŒåŠŸèƒ½ä¿¡æ¯ã€‚

### USER
è¯·åŸºäºæä¾›çš„ Java ä»£ç ï¼Œè¾“å‡ºå¦‚ä¸‹ç»“æ„åŒ–å†…å®¹ï¼ˆJSONæ ¼å¼ï¼‰ï¼š
- ç±»çš„ä¸»è¦èŒè´£
- å…³é”®å­—æ®µåŠå…¶å«ä¹‰
- å…³é”®æ–¹æ³•åŠå…¶åŠŸèƒ½

è¿”å›æ ¼å¼å¦‚ä¸‹ï¼š

{
  "class_purpose": "è¯¥ç±»ä¸»è¦å®ç°ä»€ä¹ˆåŠŸèƒ½ï¼Ÿ",
  "key_fields": [
    {"name": "å­—æ®µå", "description": "å­—æ®µçš„ä½œç”¨"},
    ...
  ],
  "key_methods": [
    {"name": "æ–¹æ³•å", "description": "æ–¹æ³•çš„èŒè´£"},
    ...
  ]
}

Java æºç å¦‚ä¸‹ï¼š
{code}
```

#### English Version

```
### SYSTEM
You are a Java architecture analyst. The following Java class is a superclass involved in a Cyclic Hierarchy anti-pattern. Extract its structure and functional responsibilities.

### USER
Please analyze the provided Java code and return the following structured JSON:
- The main responsibility of the class
- Key fields and their descriptions
- Key methods and their roles

Response format:

{
  "class_purpose": "What is the main purpose of this class?",
  "key_fields": [
    {"name": "FieldName", "description": "Purpose of the field"},
    ...
  ],
  "key_methods": [
    {"name": "MethodName", "description": "What this method does"},
    ...
  ]
}

Java source code:
{code}
```

------

### ğŸ”· 2. `CHILD_FILE_SUMMARY`

#### ä¸­æ–‡ç‰ˆ

```
### SYSTEM
ä½ æ˜¯ä¸€ä½ Java æ¶æ„åˆ†æå¸ˆã€‚ä»¥ä¸‹æ˜¯ä¸€ä¸ª Cyclic Hierarchyï¼ˆå¾ªç¯ç»§æ‰¿ï¼‰åæ¨¡å¼ä¸­çš„å­ç±»æ–‡ä»¶ï¼Œè¯·ä½ æå–å…¶ä»£ç ç»“æ„å’ŒåŠŸèƒ½ä¿¡æ¯ã€‚

### USER
è¯·åŸºäº Java æºç æå–å¦‚ä¸‹ç»“æ„åŒ–ä¿¡æ¯ï¼ˆJSONæ ¼å¼ï¼‰ï¼š
- ç±»çš„ä¸»è¦èŒè´£
- å…³é”®å­—æ®µåŠå…¶å«ä¹‰
- å…³é”®æ–¹æ³•åŠå…¶åŠŸèƒ½

æ ¼å¼å¦‚ä¸‹ï¼š

{
  "class_purpose": "è¯¥ç±»çš„ä¸»è¦åŠŸèƒ½",
  "key_fields": [
    {"name": "å­—æ®µå", "description": "å­—æ®µçš„ç”¨é€”"}
  ],
  "key_methods": [
    {"name": "æ–¹æ³•å", "description": "æ–¹æ³•çš„ç”¨é€”"}
  ]
}

å­ç±»æºç å¦‚ä¸‹ï¼š
{code}
```

#### English Version

```
### SYSTEM
You are a Java architecture analyst. The following class is a subclass involved in a Cyclic Hierarchy anti-pattern. Please extract its structure and responsibilities.

### USER
Please extract the following structured data (JSON format):
- The overall purpose of the class
- Key fields and their usage
- Key methods and what they do

Expected format:

{
  "class_purpose": "Main functionality of the class",
  "key_fields": [
    {"name": "FieldName", "description": "Usage of the field"}
  ],
  "key_methods": [
    {"name": "MethodName", "description": "Function of the method"}
  ]
}

Subclass code:
{code}
```

------

### ğŸ”· 3. `PARENT_METHOD_SUMMARY`

#### ä¸­æ–‡ç‰ˆ

```
### SYSTEM
ä½ æ˜¯ä¸€ä½ Java åæ¨¡å¼åˆ†æä¸“å®¶ã€‚ä»¥ä¸‹æ–¹æ³•å®šä¹‰äºçˆ¶ç±»ä¸­ï¼Œå¹¶è°ƒç”¨äº†å­ç±»ä¸­çš„æ–¹æ³•ï¼Œè¿™æ˜¯ Cyclic Hierarchy åæ¨¡å¼çš„é‡è¦ç»„æˆéƒ¨åˆ†ã€‚

### USER
è¯·åˆ†æè¯¥æ–¹æ³•ï¼Œå¹¶è¾“å‡ºå¦‚ä¸‹ç»“æ„åŒ–ä¿¡æ¯ï¼ˆJSONæ ¼å¼ï¼‰ï¼š

{
  "method_purpose": "è¯¥æ–¹æ³•çš„åŠŸèƒ½æ˜¯ä»€ä¹ˆï¼Ÿ",
  "cyclic_hierarchy_relation": "å®ƒæ˜¯å¦‚ä½•è¡¨ç°å‡ºçˆ¶ç±»ä¾èµ–å­ç±»çš„ï¼Ÿ",
  "design_issues": [
    "è¯¥æ–¹æ³•å¯èƒ½å­˜åœ¨çš„é—®é¢˜",
    "..."
  ]
}

æ–¹æ³•æºç å¦‚ä¸‹ï¼š
{code}
```

#### English Version

```
### SYSTEM
You are an expert in analyzing anti-patterns. The following method is defined in a superclass and calls a method from a subclass, which contributes to a Cyclic Hierarchy.

### USER
Please analyze the method and return the following JSON structure:

{
  "method_purpose": "What does this method do?",
  "cyclic_hierarchy_relation": "How does it indicate the superclass depends on the subclass?",
	"design_issues": [
    "The possible problems of this method",
    "..."
  ]
}

Method source code:
{code}
```

------

### ğŸ”· 4. `CHILD_METHOD_SUMMARY`

#### ä¸­æ–‡ç‰ˆ

```
### SYSTEM
ä½ æ˜¯ä¸€ä½ Java æ¶æ„åˆ†æä¸“å®¶ã€‚ä»¥ä¸‹æ˜¯å­ç±»ä¸­è¢«çˆ¶ç±»è°ƒç”¨çš„æ–¹æ³•ï¼Œå®ƒæ˜¯ Cyclic Hierarchy åæ¨¡å¼ä¸­çš„å…³é”®ç»„æˆã€‚

### USER
è¯·åˆ†æè¯¥æ–¹æ³•ï¼Œå¹¶è¿”å›å¦‚ä¸‹ç»“æ„åŒ– JSONï¼š

{
  "method_purpose": "è¯¥æ–¹æ³•çš„åŠŸèƒ½",
  "exposed_details": "æš´éœ²ç»™çˆ¶ç±»çš„å®ç°ç»†èŠ‚",
  "cyclic_hierarchy_impact": "å­ç±»çš„è¯¥æ–¹æ³•å¯èƒ½å¦‚ä½•è¢«çˆ¶ç±»è°ƒç”¨å¼•å‘å¾ªç¯ä¾èµ–"
}

æ–¹æ³•æºç å¦‚ä¸‹ï¼š
{code}
```

### English Version

```
### SYSTEM
You are a software architecture expert. The following method is defined in a subclass and is invoked by the superclass â€” a key symptom of Cyclic Hierarchy.

### USER
Please analyze and return the following JSON:

{
  "method_purpose": "What is the methodâ€™s purpose?",
  "exposed_details": "What internal details are exposed to the superclass?",
  "cyclic_hierarchy_impact": "How could this method of the subclass be called by the parent class to cause a circular dependency?"
}

Method source code:
{code}
```

------

## ğŸ”· 5. `INVOCATION_SUMMARY`

#### ä¸­æ–‡ç‰ˆï¼ˆè½»é‡ï¼‰

```
### SYSTEM
ä½ æ˜¯ä¸€ä½ Java ä»£ç åˆ†æä¸“å®¶ã€‚ä»¥ä¸‹æ˜¯ä¸€è¡Œè°ƒç”¨è¯­å¥ï¼Œå‘ç”Ÿåœ¨çˆ¶ç±»ä¸­ï¼Œè°ƒç”¨äº†å­ç±»çš„æ–¹æ³•ã€‚è¿™æ˜¯ Cyclic Hierarchy åæ¨¡å¼ä¸­çš„å…¸å‹ç‰¹å¾ã€‚

### USER
è¯·åˆ†æè¯¥è°ƒç”¨è¡Œä¸ºï¼Œè¾“å‡ºä»¥ä¸‹ JSONï¼š

{
  "invocation_purpose": "è¿™è¡Œè°ƒç”¨çš„ç”¨é€”",
  "cyclic_dependency_explanation": "è¯¥è°ƒç”¨æ˜¯å¦‚ä½•ä½“ç°å¾ªç¯ä¾èµ–çš„"
}

è°ƒç”¨ä»£ç å¦‚ä¸‹ï¼š
{code}
```

### English Version (lightweight)

```
### SYSTEM
You are a Java code analysis expert. The following is a method invocation from a superclass to a subclass â€” a signature of the Cyclic Hierarchy anti-pattern.

### USER
Please return the following analysis in JSON format:

{
  "invocation_purpose": "What is the purpose of this call?",
  "cyclic_dependency_explanation": "How does this reflect a cyclic dependency?"
}

Invocation code:
{code}
```
