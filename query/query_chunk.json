{
  "antipattern_type": "CH",
  "project_name": -1,
  "commit_number": -1,
  "id": -1,
  "group_id": -1,
  "chunks": [
    {
      "file_path": "/data/sanglei/Anti-patternRAG/query/before/clients/src/main/java/org/apache/kafka/common/requests/AbstractResponse.java",
      "chunk_type": "parent_method",
      "chunk_id": "parent_method",
      "level": 3,
      "parent_chunk_id": null,
      "ast_subtree": "(method_declaration (modifiers) type: (type_identifier) name: (identifier) parameters: (formal_parameters (formal_parameter type: (type_identifier) name: (identifier)) (formal_parameter type: (type_identifier) name: (identifier)) (formal_parameter type: (integral_type) name: (identifier))) body: (block (switch_expression condition: (parenthesized_expression (identifier)) body: (switch_block (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label) (throw_statement (object_creation_expression type: (type_identifier) arguments: (argument_list (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (binary_expression left: (string_literal (string_fragment)) right: (string_literal (string_fragment))) (identifier)))))))))))"
    },
    {
      "file_path": "/data/sanglei/Anti-patternRAG/query/before/clients/src/main/java/org/apache/kafka/common/requests/AbstractResponse.java",
      "chunk_type": "parent_call_child",
      "chunk_id": "parent_call_child",
      "level": 3,
      "parent_chunk_id": null,
      "ast_subtree": "(return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))"
    },
    {
      "file_path": "/data/sanglei/Anti-patternRAG/query/before/clients/src/main/java/org/apache/kafka/common/requests/AbstractResponse.java",
      "chunk_type": "parent_file_structure",
      "chunk_id": "parent_file_structure",
      "level": 3,
      "parent_chunk_id": null,
      "ast_subtree": "(program (block_comment) (package_declaration (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier)) name: (identifier))) (class_declaration (modifiers) name: (identifier) interfaces: (super_interfaces (type_list (type_identifier))) body: (class_body (field_declaration (modifiers) type: (integral_type) declarator: (variable_declarator name: (identifier) value: (decimal_integer_literal))) (field_declaration (modifiers) type: (type_identifier) declarator: (variable_declarator name: (identifier))) (constructor_declaration (modifiers) name: (identifier) parameters: (formal_parameters (formal_parameter type: (type_identifier) name: (identifier))) body: (constructor_body (expression_statement (assignment_expression left: (field_access object: (this) field: (identifier)) right: (identifier))))) (method_declaration (modifiers) type: (type_identifier) name: (identifier) parameters: (formal_parameters (formal_parameter type: (type_identifier) name: (identifier)) (formal_parameter type: (integral_type) name: (identifier))) body: (block (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (method_invocation name: (identifier) arguments: (argument_list)) (identifier)))))) (block_comment) (method_declaration (modifiers) type: (type_identifier) name: (identifier) parameters: (formal_parameters (formal_parameter type: (type_identifier) name: (identifier)) (formal_parameter type: (integral_type) name: (identifier))) body: (block (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)) (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)) (method_invocation name: (identifier) arguments: (argument_list)) (identifier)))))) (line_comment) (method_declaration (modifiers) type: (type_identifier) name: (identifier) parameters: (formal_parameters (formal_parameter type: (integral_type) name: (identifier))) body: (block (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (method_invocation name: (identifier) arguments: (argument_list)) (identifier)))))) (block_comment) (method_declaration (modifiers) type: (generic_type (type_identifier) (type_arguments (type_identifier) (type_identifier))) name: (identifier) parameters: (formal_parameters)) (method_declaration (modifiers) type: (generic_type (type_identifier) (type_arguments (type_identifier) (type_identifier))) name: (identifier) parameters: (formal_parameters (formal_parameter type: (type_identifier) name: (identifier))) body: (block (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (decimal_integer_literal)))))) (method_declaration (modifiers) type: (generic_type (type_identifier) (type_arguments (type_identifier) (type_identifier))) name: (identifier) parameters: (formal_parameters (formal_parameter type: (generic_type (type_identifier) (type_arguments (type_identifier))) name: (identifier))) body: (block (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (lambda_expression parameters: (identifier) body: (identifier)) (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (lambda_expression parameters: (identifier) body: (decimal_integer_literal))))))))))) (method_declaration (modifiers) type: (generic_type (type_identifier) (type_arguments (type_identifier) (type_identifier))) name: (identifier) parameters: (formal_parameters (formal_parameter type: (generic_type (type_identifier) (type_arguments (type_identifier))) name: (identifier))) body: (block (local_variable_declaration type: (generic_type (type_identifier) (type_arguments (type_identifier) (type_identifier))) declarator: (variable_declarator name: (identifier) value: (object_creation_expression type: (generic_type (type_identifier) (type_arguments)) arguments: (argument_list)))) (enhanced_for_statement type: (type_identifier) name: (identifier) value: (identifier) body: (expression_statement (method_invocation name: (identifier) arguments: (argument_list (identifier) (identifier))))) (return_statement (identifier)))) (method_declaration (modifiers) type: (generic_type (type_identifier) (type_arguments (type_identifier) (type_identifier))) name: (identifier) parameters: (formal_parameters (formal_parameter type: (generic_type (type_identifier) (type_arguments (wildcard) (type_identifier))) name: (identifier))) body: (block (local_variable_declaration type: (generic_type (type_identifier) (type_arguments (type_identifier) (type_identifier))) declarator: (variable_declarator name: (identifier) value: (object_creation_expression type: (generic_type (type_identifier) (type_arguments)) arguments: (argument_list)))) (enhanced_for_statement type: (type_identifier) name: (identifier) value: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)) body: (expression_statement (method_invocation name: (identifier) arguments: (argument_list (identifier) (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)))))) (return_statement (identifier)))) (method_declaration (modifiers) type: (void_type) name: (identifier) parameters: (formal_parameters (formal_parameter type: (generic_type (type_identifier) (type_arguments (type_identifier) (type_identifier))) name: (identifier)) (formal_parameter type: (type_identifier) name: (identifier))) body: (block (local_variable_declaration type: (type_identifier) declarator: (variable_declarator name: (identifier) value: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (decimal_integer_literal))))) (expression_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (binary_expression left: (identifier) right: (decimal_integer_literal))))))) (block_comment) (method_declaration (modifiers) type: (type_identifier) name: (identifier) parameters: (formal_parameters (formal_parameter type: (type_identifier) name: (identifier)) (formal_parameter type: (type_identifier) name: (identifier))) body: (block (local_variable_declaration type: (type_identifier) declarator: (variable_declarator name: (identifier) value: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)))) (local_variable_declaration type: (integral_type) declarator: (variable_declarator name: (identifier) value: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)))) (local_variable_declaration type: (type_identifier) declarator: (variable_declarator name: (identifier) value: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier))))))) (if_statement condition: (parenthesized_expression (binary_expression left: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)) right: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)))) consequence: (block (throw_statement (object_creation_expression type: (type_identifier) arguments: (argument_list (binary_expression left: (binary_expression left: (binary_expression left: (binary_expression left: (binary_expression left: (string_literal (string_fragment)) right: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list))) right: (string_literal (string_fragment))) right: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list))) right: (string_literal (string_fragment))) right: (identifier)) (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)) (method_invocation object: (identifier) name: (identifier) arguments: (argument_list))))))) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier) (identifier)))))) (method_declaration (modifiers) type: (type_identifier) name: (identifier) parameters: (formal_parameters (formal_parameter type: (type_identifier) name: (identifier)) (formal_parameter type: (type_identifier) name: (identifier)) (formal_parameter type: (integral_type) name: (identifier))) body: (block (switch_expression condition: (parenthesized_expression (identifier)) body: (switch_block (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label (identifier)) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (identifier))))) (switch_block_statement_group (switch_label) (throw_statement (object_creation_expression type: (type_identifier) arguments: (argument_list (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (binary_expression left: (string_literal (string_fragment)) right: (string_literal (string_fragment))) (identifier))))))))))) (block_comment) (method_declaration (modifiers) type: (boolean_type) name: (identifier) parameters: (formal_parameters (formal_parameter type: (integral_type) name: (identifier))) body: (block (return_statement (false)))) (method_declaration (modifiers) type: (type_identifier) name: (identifier) parameters: (formal_parameters) body: (block (return_statement (identifier)))) (block_comment) (method_declaration (modifiers) type: (integral_type) name: (identifier) parameters: (formal_parameters)) (block_comment) (method_declaration (modifiers) type: (void_type) name: (identifier) parameters: (formal_parameters (formal_parameter type: (integral_type) name: (identifier)))) (method_declaration (modifiers) type: (type_identifier) name: (identifier) parameters: (formal_parameters) body: (block (return_statement (method_invocation object: (method_invocation name: (identifier) arguments: (argument_list)) name: (identifier) arguments: (argument_list))))))))"
    },
    {
      "file_path": "/data/sanglei/Anti-patternRAG/query/before/clients/src/main/java/org/apache/kafka/common/requests/AbstractResponse.java",
      "chunk_type": "parent_file_summary",
      "chunk_id": "parent_file_summary",
      "level": 3,
      "parent_chunk_id": null,
      "llm_description": "{\n  \"class_purpose\": \"AbstractResponse provides a common base for all Kafka protocol response types. It encapsulates shared behavior such as serialization, parsing, error counting, throttle‑time handling, and exposing the associated ApiKey. Concrete response classes extend this class and implement the abstract methods to supply their specific payload data.\",\n  \"key_fields\": [\n    {\n      \"name\": \"DEFAULT_THROTTLE_TIME\",\n      \"description\": \"Constant representing the default (zero) throttle time in milliseconds for responses that do not include a throttle‑time field.\"\n    },\n    {\n      \"name\": \"apiKey\",\n      \"description\": \"The ApiKeys enum value that identifies which Kafka API this response belongs to (e.g., PRODUCE, FETCH). It is set in the constructor and used for routing parsing logic and for client‑side throttling decisions.\"\n    }\n  ],\n  \"key_methods\": [\n    {\n      \"name\": \"AbstractResponse(ApiKeys apiKey)\",\n      \"description\": \"Protected constructor that stores the API key of the concrete response.\"\n    },\n    {\n      \"name\": \"toSend(ResponseHeader header, short version)\",\n      \"description\": \"Creates a Send object that contains the fully‑framed response (size prefix, header, and body) ready to be written to a network channel.\"\n    },\n    {\n      \"name\": \"serializeWithHeader(ResponseHeader header, short version)\",\n      \"description\": \"Serializes the response together with its header into a ByteBuffer **without** the size prefix, useful for internal testing or when the size is added elsewhere.\"\n    },\n    {\n      \"name\": \"serialize(short version)\",\n      \"description\": \"Serializes only the response body (the protocol message) into a ByteBuffer; primarily exposed for testing.\"\n    },\n    {\n      \"name\": \"errorCounts()\",\n      \"description\": \"Abstract method that concrete responses must implement to return a map of each Errors enum value present in the response and its occurrence count.\"\n    },\n    {\n      \"name\": \"errorCounts(Errors error)\",\n      \"description\": \"Utility that creates a singleton error‑count map for a single error value.\"\n    },\n    {\n      \"name\": \"errorCounts(Stream<Errors> errors)\",\n      \"description\": \"Collects a stream of Errors into a map that groups by error type and counts occurrences.\"\n    },\n    {\n      \"name\": \"errorCounts(Collection<Errors> errors)\",\n      \"description\": \"Iterates over a collection of Errors and builds the error‑count map using `updateErrorCounts`.\"\n    },\n    {\n      \"name\": \"apiErrorCounts(Map<?, ApiError> errors)\",\n      \"description\": \"Converts a map whose values are ApiError objects into an error‑count map by extracting the underlying Errors enum.\"\n    },\n    {\n      \"name\": \"updateErrorCounts(Map<Errors, Integer> errorCounts, Errors error)\",\n      \"description\": \"Helper that increments the count for a given error in the supplied map (creates entry with count 1 if absent).\"\n    },\n    {\n      \"name\": \"parseResponse(ByteBuffer buffer, RequestHeader requestHeader)\",\n      \"description\": \"Static factory that reads a ResponseHeader from the buffer, validates the correlation ID against the request, and then delegates to the overload that takes an ApiKeys value.\"\n    },\n    {\n      \"name\": \"parseResponse(ApiKeys apiKey, ByteBuffer responseBuffer, short version)\",\n      \"description\": \"Large switch‑statement that, based on the supplied ApiKeys, invokes the appropriate concrete response class’s static `parse` method to deserialize the remaining payload.\"\n    },\n    {\n      \"name\": \"shouldClientThrottle(short version)\",\n      \"description\": \"Indicates whether a client should apply throttling when it receives this response with a non‑zero throttle time. The default implementation returns `false`; newer response types may override it.\"\n    },\n    {\n      \"name\": \"apiKey()\",\n      \"description\": \"Getter for the stored ApiKeys value.\"\n    },\n    {\n      \"name\": \"throttleTimeMs()\",\n      \"description\": \"Abstract method that concrete responses must implement to return the throttle time (in ms) present in the response schema, or 0 if the schema does not support throttling.\"\n    },\n    {\n      \"name\": \"maybeSetThrottleTimeMs(int throttleTimeMs)\",\n      \"description\": \"Abstract method that concrete responses implement to set the throttle‑time field when the schema supports it; otherwise it is a no‑op.\"\n    },\n    {\n      \"name\": \"toString()\",\n      \"description\": \"Overrides `Object.toString()` to return the string representation of the underlying protocol data object (`data()`).\"\n    }\n  ]\n}"
    },
    {
      "file_path": "/data/sanglei/Anti-patternRAG/query/before/clients/src/main/java/org/apache/kafka/common/requests/AbstractResponse.java",
      "chunk_type": "parent_method_summary",
      "chunk_id": "parent_method_summary",
      "level": 3,
      "parent_chunk_id": null,
      "llm_description": "```json\n{\n  \"method_purpose\": \"The method is a central dispatch routine that reads a binary `ByteBuffer` containing a Kafka protocol response, looks at the `ApiKey` that identifies which kind of response is encoded, and then forwards the buffer (together with the protocol version) to the static `parse` method of the concrete response class. The concrete `parse` method builds and returns an instance of a subclass of `AbstractResponse` that represents the decoded response.\",\n  \"cyclic_hierarchy_relation\": \"The method lives (most often) in a utility class that is conceptually part of the *response* hierarchy – it knows about `AbstractResponse` (the common super‑type) **and** about every concrete subclass (`ProduceResponse`, `FetchResponse`, …). In effect the “super‑class” (`AbstractResponse`) is being *used* to refer to a set of *sub‑classes* that are hard‑coded in the method. This creates a reverse dependency: the higher‑level abstraction (the parser that returns `AbstractResponse`) is tightly coupled to the low‑level implementations, which is the opposite of the usual direction where subclasses depend on the abstract base. The relationship can be seen as a cyclic hierarchy because the abstract type is expected to be independent, yet the parser forces the abstract type to know about each concrete implementation.\",\n  \"design_issues\": [\n    \"**Huge switch statement** – every time a new Kafka API is added a new case must be added here. This violates the Open/Closed Principle (the class is not closed for modification).\",\n    \"**Tight coupling / super‑type depends on sub‑types** – the parser must import and reference every concrete response class, making the codebase fragile and harder to evolve.\",\n    \"**Risk of missing updates** – forgetting to add a case for a new `ApiKey` results in an `AssertionError` at runtime, which can surface only in production.\",\n    \"**Scalability / maintenance** – the method grows linearly with the number of API keys; readability suffers and code reviews become cumbersome.\",\n    \"**No compile‑time safety** – the compiler cannot guarantee that the version supplied to a particular `parse` call is valid for that API; the check is deferred to the concrete parser implementation.\",\n    \"**Static dispatch instead of polymorphism** – the design discards the opportunity to let each response type register its own parser (e.g., via a map or a factory interface), which would remove the switch entirely.\",\n    \"**Potential ByteBuffer mutation bugs** – the same `ByteBuffer` is passed to many parsers; if any parser does not correctly manage the buffer’s position, subsequent parsers could see corrupted data.\",\n    \"**Testing difficulty** – unit‑testing the method requires a full set of response classes and corresponding binary fixtures; a change in any response parser forces re‑testing of this central dispatcher.\",\n    \"**Performance overhead** – the switch is executed for every response, adding a branch‑prediction cost; a map‑based lookup would be O(1) with less branching.\",\n    \"**Error handling is coarse** – any parsing exception bubbles up as a generic `AssertionError` with a message that only mentions an unhandled `ApiKey`, hiding the real cause of the failure.\"\n  ]\n}\n```"
    },
    {
      "file_path": "/data/sanglei/Anti-patternRAG/query/before/clients/src/main/java/org/apache/kafka/common/requests/AbstractResponse.java",
      "chunk_type": "invocation_summary",
      "chunk_id": "invocation_summary",
      "level": 3,
      "parent_chunk_id": null,
      "llm_description": "```json\n{\n  \"invocation_purpose\": \"The call invokes the static `parse` method of the `LeaderAndIsrResponse` class to deserialize a raw `responseBuffer` (a binary payload received from the network) into a fully‑populated `LeaderAndIsrResponse` object using the supplied protocol `version`. This enables the caller to work with a typed representation of the Leader‑and‑ISR response instead of raw bytes.\",\n  \"cyclic_dependency_explanation\": \"In the Kafka codebase the `LeaderAndIsrResponse.parse` implementation typically relies on other protocol‑specific classes (e.g., `ResponseHeader`, `ErrorCodes`, `ReplicaInfo`) to read fields from the buffer. Some of those helper classes, in turn, import or reference `LeaderAndIsrResponse`—for example, to expose constants, share validation logic, or construct nested response objects. This mutual import creates a compile‑time cyclic dependency: `LeaderAndIsrResponse → HelperClass → LeaderAndIsrResponse`. While Java can handle cyclic references at runtime, such cycles can complicate the build (requiring forward declarations or breaking the dependency chain) and increase the risk of class‑loading issues. The presence of the `parse` call highlights the cycle because the method’s body must traverse those inter‑dependent types to interpret the buffer.\"\n}\n```"
    },
    {
      "file_path": "/data/sanglei/Anti-patternRAG/query/before/clients/src/main/java/org/apache/kafka/common/requests/LeaderAndIsrResponse.java",
      "chunk_type": "child_method",
      "chunk_id": "child_method",
      "level": 3,
      "parent_chunk_id": null,
      "ast_subtree": "(method_declaration (modifiers) type: (type_identifier) name: (identifier) parameters: (formal_parameters (formal_parameter type: (type_identifier) name: (identifier)) (formal_parameter type: (integral_type) name: (identifier))) body: (block (return_statement (object_creation_expression type: (type_identifier) arguments: (argument_list (object_creation_expression type: (type_identifier) arguments: (argument_list (object_creation_expression type: (type_identifier) arguments: (argument_list (identifier))) (identifier))) (identifier))))))"
    },
    {
      "file_path": "/data/sanglei/Anti-patternRAG/query/before/clients/src/main/java/org/apache/kafka/common/requests/LeaderAndIsrResponse.java",
      "chunk_type": "child_file_structure",
      "chunk_id": "child_file_structure",
      "level": 3,
      "parent_chunk_id": null,
      "ast_subtree": "(program (block_comment) (package_declaration (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier))) (import_declaration (scoped_identifier scope: (scoped_identifier scope: (identifier) name: (identifier)) name: (identifier))) (class_declaration (modifiers) name: (identifier) superclass: (superclass (type_identifier)) body: (class_body (block_comment) (field_declaration (modifiers) type: (type_identifier) declarator: (variable_declarator name: (identifier))) (field_declaration (modifiers) type: (integral_type) declarator: (variable_declarator name: (identifier))) (constructor_declaration (modifiers) name: (identifier) parameters: (formal_parameters (formal_parameter type: (type_identifier) name: (identifier)) (formal_parameter type: (integral_type) name: (identifier))) body: (constructor_body (explicit_constructor_invocation constructor: (super) arguments: (argument_list (field_access object: (identifier) field: (identifier)))) (expression_statement (assignment_expression left: (field_access object: (this) field: (identifier)) right: (identifier))) (expression_statement (assignment_expression left: (field_access object: (this) field: (identifier)) right: (identifier))))) (method_declaration (modifiers) type: (type_identifier) name: (identifier) parameters: (formal_parameters) body: (block (return_statement (method_invocation object: (field_access object: (this) field: (identifier)) name: (identifier) arguments: (argument_list))))) (method_declaration (modifiers) type: (type_identifier) name: (identifier) parameters: (formal_parameters) body: (block (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (method_invocation object: (identifier) name: (identifier) arguments: (argument_list))))))) (method_declaration (modifiers (marker_annotation name: (identifier))) type: (generic_type (type_identifier) (type_arguments (type_identifier) (type_identifier))) name: (identifier) parameters: (formal_parameters) body: (block (local_variable_declaration type: (type_identifier) declarator: (variable_declarator name: (identifier) value: (method_invocation name: (identifier) arguments: (argument_list)))) (if_statement condition: (parenthesized_expression (binary_expression left: (identifier) right: (field_access object: (identifier) field: (identifier)))) consequence: (block (line_comment) (if_statement condition: (parenthesized_expression (binary_expression left: (identifier) right: (decimal_integer_literal))) consequence: (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (binary_expression left: (method_invocation object: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)) name: (identifier) arguments: (argument_list)) right: (decimal_integer_literal)))))) (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (identifier) (binary_expression left: (method_invocation object: (method_invocation object: (method_invocation object: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)) name: (identifier) arguments: (argument_list)) name: (identifier) arguments: (argument_list (lambda_expression parameters: (identifier) body: (method_invocation object: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)) name: (identifier) arguments: (argument_list))))) name: (identifier) arguments: (argument_list)) right: (decimal_integer_literal))))))) (local_variable_declaration type: (generic_type (type_identifier) (type_arguments (type_identifier) (type_identifier))) declarator: (variable_declarator name: (identifier))) (if_statement condition: (parenthesized_expression (binary_expression left: (identifier) right: (decimal_integer_literal))) consequence: (expression_statement (assignment_expression left: (identifier) right: (method_invocation name: (identifier) arguments: (argument_list (method_invocation object: (method_invocation object: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)) name: (identifier) arguments: (argument_list)) name: (identifier) arguments: (argument_list (lambda_expression parameters: (identifier) body: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (method_invocation object: (identifier) name: (identifier) arguments: (argument_list))))))))))) alternative: (expression_statement (assignment_expression left: (identifier) right: (method_invocation name: (identifier) arguments: (argument_list (method_invocation object: (method_invocation object: (method_invocation object: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)) name: (identifier) arguments: (argument_list)) name: (identifier) arguments: (argument_list (lambda_expression parameters: (identifier) body: (method_invocation object: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)) name: (identifier) arguments: (argument_list))))) name: (identifier) arguments: (argument_list (lambda_expression parameters: (identifier) body: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)))))))))))) (expression_statement (method_invocation name: (identifier) arguments: (argument_list (identifier) (field_access object: (identifier) field: (identifier))))) (return_statement (identifier)))) (method_declaration (modifiers) type: (generic_type (type_identifier) (type_arguments (type_identifier) (type_identifier))) name: (identifier) parameters: (formal_parameters (formal_parameter type: (generic_type (type_identifier) (type_arguments (type_identifier) (type_identifier))) name: (identifier))) body: (block (local_variable_declaration type: (generic_type (type_identifier) (type_arguments (type_identifier) (type_identifier))) declarator: (variable_declarator name: (identifier) value: (object_creation_expression type: (generic_type (type_identifier) (type_arguments)) arguments: (argument_list)))) (if_statement condition: (parenthesized_expression (binary_expression left: (identifier) right: (decimal_integer_literal))) consequence: (block (expression_statement (method_invocation object: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)) name: (identifier) arguments: (argument_list (lambda_expression parameters: (identifier) body: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (object_creation_expression type: (type_identifier) arguments: (argument_list (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)) (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)))) (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (method_invocation object: (identifier) name: (identifier) arguments: (argument_list))))))))))) alternative: (block (enhanced_for_statement type: (type_identifier) name: (identifier) value: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)) body: (block (local_variable_declaration type: (type_identifier) declarator: (variable_declarator name: (identifier) value: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)))))) (if_statement condition: (parenthesized_expression (binary_expression left: (identifier) right: (null_literal))) consequence: (block (expression_statement (method_invocation object: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)) name: (identifier) arguments: (argument_list (lambda_expression parameters: (identifier) body: (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (object_creation_expression type: (type_identifier) arguments: (argument_list (identifier) (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)))) (method_invocation object: (identifier) name: (identifier) arguments: (argument_list (method_invocation object: (identifier) name: (identifier) arguments: (argument_list)))))))))))))))) (return_statement (identifier)))) (method_declaration (modifiers (marker_annotation name: (identifier))) type: (integral_type) name: (identifier) parameters: (formal_parameters) body: (block (return_statement (identifier)))) (method_declaration (modifiers (marker_annotation name: (identifier))) type: (void_type) name: (identifier) parameters: (formal_parameters (formal_parameter type: (integral_type) name: (identifier))) body: (block (line_comment))) (method_declaration (modifiers) type: (type_identifier) name: (identifier) parameters: (formal_parameters (formal_parameter type: (type_identifier) name: (identifier)) (formal_parameter type: (integral_type) name: (identifier))) body: (block (return_statement (object_creation_expression type: (type_identifier) arguments: (argument_list (object_creation_expression type: (type_identifier) arguments: (argument_list (object_creation_expression type: (type_identifier) arguments: (argument_list (identifier))) (identifier))) (identifier)))))) (method_declaration (modifiers (marker_annotation name: (identifier))) type: (type_identifier) name: (identifier) parameters: (formal_parameters) body: (block (return_statement (identifier)))) (method_declaration (modifiers (marker_annotation name: (identifier))) type: (type_identifier) name: (identifier) parameters: (formal_parameters) body: (block (return_statement (method_invocation object: (identifier) name: (identifier) arguments: (argument_list))))))))"
    },
    {
      "file_path": "/data/sanglei/Anti-patternRAG/query/before/clients/src/main/java/org/apache/kafka/common/requests/LeaderAndIsrResponse.java",
      "chunk_type": "child_file_summary",
      "chunk_id": "child_file_summary",
      "level": 3,
      "parent_chunk_id": null,
      "llm_description": "```json\n{\n  \"class_purpose\": \"Encapsulates the response for the LEADER_AND_ISR request in Apache Kafka, exposing the response data, top‑level and per‑partition error information, and utilities for parsing and interpreting that data.\",\n  \"key_fields\": [\n    {\n      \"name\": \"data\",\n      \"description\": \"The generated `LeaderAndIsrResponseData` object that holds the raw response payload (error code, topic/partition error collections, etc.).\"\n    },\n    {\n      \"name\": \"version\",\n      \"description\": \"The schema version of the response; influences how error counts and partition errors are interpreted (pre‑v5 uses flat structures, v5+ uses per‑topic collections).\"\n    }\n  ],\n  \"key_methods\": [\n    {\n      \"name\": \"LeaderAndIsrResponse(LeaderAndIsrResponseData data, short version)\",\n      \"description\": \"Constructor that creates a response instance, storing the raw response data and the protocol version.\"\n    },\n    {\n      \"name\": \"topics()\",\n      \"description\": \"Returns the collection of `LeaderAndIsrTopicError` objects (per‑topic error information) from the underlying data.\"\n    },\n    {\n      \"name\": \"error()\",\n      \"description\": \"Extracts the top‑level error code from the response and converts it to an `Errors` enum value.\"\n    },\n    {\n      \"name\": \"errorCounts()\",\n      \"description\": \"Computes a map of each distinct `Errors` value to the number of affected partitions (including the top‑level error if present). Handles both pre‑v5 and v5+ response formats.\"\n    },\n    {\n      \"name\": \"partitionErrors(Map<Uuid, String> topicNames)\",\n      \"description\": \"Builds a `Map<TopicPartition, Errors>` that maps each partition to its specific error, translating topic IDs to names for v5+ responses.\"\n    }\n  ]\n}\n```"
    },
    {
      "file_path": "/data/sanglei/Anti-patternRAG/query/before/clients/src/main/java/org/apache/kafka/common/requests/LeaderAndIsrResponse.java",
      "chunk_type": "child_method_summary",
      "chunk_id": "child_method_summary",
      "level": 3,
      "parent_chunk_id": null,
      "llm_description": "```json\n{\n  \"method_purpose\": \"The static `parse` method converts a raw `ByteBuffer` that contains the binary representation of a Kafka **LeaderAndIsrResponse** into a fully‑initialised Java object. It does this by wrapping the buffer in a `ByteBufferAccessor`, constructing a `LeaderAndIsrResponseData` instance (which knows how to read the protocol fields for the given version), and finally creating a `LeaderAndIsrResponse` that carries both the parsed data and the protocol version. In short, it is a factory method that deserialises network data into the high‑level response model used by the client or broker code.\",\n  \"exposed_details\": \"The method hands the following internal details to the superclass (the `AbstractResponse` hierarchy that `LeaderAndIsrResponse` extends):\\n1. **The parsed data object** – an instance of `LeaderAndIsrResponseData` that contains all the fields (error code, leader epoch, ISR list, etc.) extracted from the buffer. This object is passed to the `LeaderAndIsrResponse` constructor, which in turn forwards it to its parent via `super(data, version)`.\\n2. **The protocol version** – the `short version` argument is also forwarded to the parent class. The parent may use the version to decide how to render the response, compute its size, or perform version‑specific validation.\\n3. **The underlying byte‑buffer accessor** – although not passed directly, the `ByteBufferAccessor` is used by `LeaderAndIsrResponseData` to read the raw bytes, so the parent class indirectly receives a view of the original buffer through the data object.\\nThus, the subclass is exposing the low‑level deserialized payload and the version flag to the generic response handling logic defined in the superclass.\",\n  \"cyclic_hierarchy_impact\": \"If the parent class (or any intermediate abstract class) provides a generic `parse(ByteBuffer, short)` method that attempts to instantiate the concrete subclass via reflection or a registration‑based factory, a circular call chain can arise:\\n\\n```java\\n// In the abstract parent class\\npublic static <T extends AbstractResponse> T parse(ByteBuffer buf, short version) {\\n    // Look up the concrete class for the given API key / version\\n    Class<T> concrete = registry.get(ApiKey.LEADER_AND_ISR_RESPONSE);\\n    // Delegates to the subclass static parse method\\n    return concrete.getMethod(\\\"parse\\\", ByteBuffer.class, short.class)\\n                    .invoke(null, buf, version);\\n}\\n```\\n\\nIf the concrete subclass (`LeaderAndIsrResponse`) overrides `parse` **and** the parent’s implementation (perhaps in a helper method) also calls `LeaderAndIsrResponse.parse` to obtain the object, the flow becomes:\\n1. Client code calls `LeaderAndIsrResponse.parse(buf, v)`. \\n2. Inside that method, a new `LeaderAndIsrResponse` is constructed, which invokes `super(data, version)`.\\n3. The superclass constructor (or a method it calls) might invoke the generic `AbstractResponse.parse(buf, v)` to perform additional validation or logging.\\n4. The generic `parse` again looks up the concrete class and calls `LeaderAndIsrResponse.parse` – back to step 1.\\n\\nThis creates an infinite recursion (a circular dependency) that would eventually overflow the stack. The problem typically surfaces when the parent class assumes it can safely call a static parse method on the concrete type without guarding against the concrete class already being in the process of parsing. To avoid this, the parent should either:\\n- Use a non‑static instance method for further processing, or\\n- Include a guard flag (e.g., a `ThreadLocal` parsing context) to detect re‑entrancy, or\\n- Design the hierarchy so that the parent never calls back into the subclass’s static factory.\\n\"\n}\n```"
    }
  ]
}